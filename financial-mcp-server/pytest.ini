[tool:pytest]
minversion = 7.0
addopts = 
    -ra 
    -q 
    --strict-markers 
    --strict-config
    --asyncio-mode=auto
    --tb=short
    --cov=mcp_financial
    --cov-branch
    --cov-report=term-missing
    --cov-report=html:tests/coverage/html
    --cov-report=xml:tests/coverage/coverage.xml
    --cov-fail-under=75

testpaths = 
    tests/unit
    tests/integration
    tests/e2e
    tests/performance

asyncio_mode = auto

markers =
    unit: Unit tests for individual components
    integration: Integration tests with external services
    e2e: End-to-end tests for complete workflows
    performance: Performance and load testing
    slow: Tests that take a long time to run
    auth: Authentication and authorization tests
    circuit_breaker: Circuit breaker functionality tests
    monitoring: Monitoring and observability tests
    mcp_protocol: MCP protocol compliance tests
    error_handling: Error handling and recovery tests
    concurrent: Concurrency and thread safety tests
    validation: Input validation tests
    audit: Audit trail and logging tests

python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Timeout configuration
timeout = 300
timeout_method = thread

# Logging configuration
log_cli = true
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(name)s: %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Filter warnings
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore:.*unclosed.*:ResourceWarning

# Test output formatting
console_output_style = progress